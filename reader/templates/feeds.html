{% extends "layout.html" %}

{% import "macros.html" as macros %}

{% block page_title %}Feeds{% endblock %}
{% block main_title %}Feeds{% endblock %}



{% block body %}

<form action="{{ url_for('.form_api') }}" method="post" id="add-feed">
<small>
<a href='{{ url_for('.entries') }}'>home</a>

<input type="text" name="feed-url" id="feed-url" placeholder="feed url">
<button type="submit" name="action" value="add-feed">add feed</button>

<input type="hidden" name="next" value='{{ url_for('.feeds', **request.args) }}'>
</small>
</form>
<br>


{% with messages = get_flashed_messages() %}
{% if messages %}
<p id="messages"><b>{% for message in messages %}{{ message }}. {% endfor %}</b></p>
{% endif %}
{% endwith %}


{% for feed in feeds %}

<form action="{{ url_for('.form_api') }}" method="post" id="feed-{{ loop.index }}" class="feed">

<b>{{ macros.feed_link(feed) }}</b> <br>
<small>
<a href="{{ url_for('.entries', feed=feed.url) }}">entries</a>

<input type="checkbox" name="really" id="really-{{ loop.index }}" value="really">
<label for="really-{{ loop.index }}">I really want to</label>

<button type="submit" name="action" value="delete-feed">delete feed</button>

<input type="text" name="feed-title" placeholder="feed title">
<button type="submit" name="action" value="update-feed-title">update feed title</button>

<input type="hidden" name="feed-url" value='{{ feed.url }}'>
<input type="hidden" name="next" value='{{ url_for('.feeds', **request.args) }}#feed-{{ loop.index if not loop.last else loop.index - 1 }}'>

</small>
</form>
<br>

{% endfor %}

{% endblock %}
